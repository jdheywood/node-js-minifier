{"version":3,"sources":["requestHandlers.js"],"names":[],"mappings":"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","file":"requestHandlers.js","sourcesContent":["var querystring = require(\"querystring\"),\r\n\tfs = require(\"fs\"),\r\n\tformidable = require(\"formidable\"),\r\n\tminifier = require(\"./minifier\");\r\n\r\nfunction start(response) {\r\n\tconsole.log(\"Request handler 'start' was called.\");\r\n\t\r\n\tvar body = '<html>'+\r\n\t\t'<head>'+\r\n\t\t'<meta http-equiv=\"Content-Type\" content=\"text/html; '+\r\n\t\t'charset=UTF-8\" />'+\r\n\t\t'</head>'+\r\n\t\t'<body>'+\r\n\t\t'<form action=\"/upload\" method=\"post\" enctype=\"multipart/form-data\">'+\r\n\t\t'<input type=\"file\" name=\"upload\">'+\r\n\t\t'<input type=\"submit\" value=\"Upload file\" />'+\r\n\t\t'</form>'+\r\n\t\t'</body>'+\r\n\t\t'</html>';\r\n\t\r\n\tresponse.writeHead(200, {\"Content-Type\": \"text/html\"});\r\n\tresponse.write(body);\r\n\tresponse.end();\r\n}\r\n\r\nfunction upload(response, request) {\r\n\tconsole.log(\"Request handler 'upload' was called.\");\r\n\t\r\n\tvar form = new formidable.IncomingForm();\r\n\tform.parse(request, function(error, fields, files) {\r\n\t\tconsole.log(\"parsing done\");\r\n\t\r\n\t\t/* Possible error on Windows systems: tried to rename to an already existing file */\r\n\t\tfs.rename(files.upload.path, \"/Dev/node-js-minifier/tmp/out.js\", function(error) {\r\n\t\t\tif (error) {\r\n\t\t\t\tfs.unlink(\"/Dev/node-js-minifier/tmp/out.js\");\r\n\t\t\t\tfs.rename(files.upload.path, \"/Dev/node-js-minifier/tmp/out.js\");\r\n\t\t\t}\r\n\t\t});\r\n\t\r\n\t\t/* So here is where we need to minify our incoming javascript */\r\n\t\tvar result = minifier.minify('/Dev/node-js-minifier/tmp/out.js', true);\r\n\t\tfs.writeFile('/Dev/node-js-minifier/tmp/out-min.js', result, function(err) {\r\n\t\t    if(err) {\r\n\t\t        return console.log(err);\r\n\t\t    }\r\n\t\t    console.log(\"The file was saved!\");\r\n\t\t}); \r\n\r\n\t\t/* and write it back as the response of the upload */\r\n\t\tresponse.writeHead(200, {\"content-type\": \"text/javascript\"});\r\n\t\tvar readStream = fs.createReadStream('/Dev/node-js-minifier/tmp/out-min.js');\r\n    \treadStream.pipe(response);\r\n\t});\r\n}\r\n\r\nfunction show(response) {\r\n\tconsole.log(\"Request handler 'show' was called.\");\r\n\tresponse.writeHead(200, {'content-type': 'text/javascript'});\r\n\tfs.createReadStream('/Dev/node-js-minifier/tmp/out-min.js').pipe(response);\r\n}\r\n\r\nfunction test(response) {\r\n\r\n\tvar alphanumeric_cases = ['abc123', '/*~#-', '123', 'abc'];\r\n\tvar alphanumeric_results = [];\r\n\tfor (var i = 0; i < alphanumeric_cases.length; i++) {\r\n\t\talphanumeric_results.push(minifier.isAlphanumeric(alphanumeric_cases[i]));\r\n\t};\r\n\r\n\tvar endspace_cases = ['\\n', '\\r', '\\f', ' ', ';', '', '-'];\r\n\tvar endspace_results = [];\r\n\tfor (var i = 0; i < endspace_cases.length; i++) {\r\n\t\tendspace_results.push(minifier.isEndspace(endspace_cases[i]));\r\n\t};\r\n\r\n\tvar whitespace_cases = [' ', '\\t', '\\n', '\\r', '\\f', 'a', '1'];\r\n\tvar whitespace_results = [];\r\n\tfor (var i = 0; i < whitespace_cases.length; i++) {\r\n\t\twhitespace_results.push(minifier.isWhitespace(whitespace_cases[i]));\r\n\t};\r\n\r\n\tvar infix_cases = ['a','1','+','-','/', ',', ';', ':', '=', '&', '%', '*', '<', '>', '\\?', '\\|', '\\n'];\r\n\tvar infix_results = [];\r\n\tfor (var i = 0; i < infix_cases.length; i++) {\r\n\t\tinfix_results.push(minifier.isInfix(infix_cases[i]));\r\n\t};\r\n\r\n\tvar prefix_cases = ['a','1','+', '\\{', '\\(', '\\[', '!'];\r\n\tvar prefix_results = [];\r\n\tfor (var i = 0; i < prefix_cases.length; i++) {\r\n\t\tprefix_results.push(minifier.isPrefix(prefix_cases[i]));\r\n\t};\t\r\n\r\n\tvar postfix_cases = ['a','1','+', '\\}', '\\)', '\\]'];\r\n\tvar postfix_results = [];\r\n\tfor (var i = 0; i < postfix_cases.length; i++) {\r\n\t\tpostfix_results.push(minifier.isPostfix(postfix_cases[i]));\r\n\t};\r\n\r\n\tvar getChar_case = 'hello world';\r\n\tvar getChar_result = '';\r\n\tfor (var i = 0; i < getChar_case.length; i++) {\r\n\t\tgetChar_result = getChar_result + minifier.getChar();\r\n\t}\r\n\r\n\tmyOutput = '';\r\n\tvar putChar_result = '';\r\n\tfor (var i = 0; i < getChar_case.length; i++) {\r\n\t\tminifier.putChar(minifier.getChar());\r\n\t}\r\n\r\n\tvar defined_cases = [ '', ' ', '0', false, undefined ];\r\n\tvar defined_results = [];\r\n\tfor (var i = 0; i < defined_cases.length; i++) {\r\n\t\tdefined_results.push(minifier.defined(defined_cases[i]));\r\n\t}\r\n\r\n\tmyOutput = '';\r\n\tvar result = minifier.minify('/Dev/node-js-minifier/jquery-1.11.3.js', false);\r\n\tconsole.log(result);\r\n\r\n\tvar body = '<html>'+\r\n\t\t'<head>'+\r\n\t\t'<meta http-equiv=\"Content-Type\" content=\"text/html; '+\r\n\t\t'charset=UTF-8\" />'+\r\n\t\t'</head>'+\r\n\t\t'<body>'+\r\n\t\t'<p>test: isAlphanumeric: cases = ' + alphanumeric_cases + ', results = ' + alphanumeric_results + '</p>'+\r\n\t\t'<p>test: isEndspace: cases = ' + endspace_cases + ', results = ' + endspace_results + '</p>'+\r\n\t\t'<p>test: isWhitespace: cases = ' + whitespace_cases + ', results = ' + whitespace_results + '</p>'+\r\n\t\t'<p>test: isInfix: cases = ' + infix_cases + ', results = ' + infix_results + '</p>'+\r\n\t\t'<p>test: isPrefix: cases = ' + prefix_cases + ', results = ' + prefix_results + '</p>'+\r\n\t\t'<p>test: isPostfix: cases = ' + postfix_cases + ', results = ' + postfix_results + '</p>'+\r\n\t\t'<p>test: getChar: case = ' + getChar_case + ', result = ' + getChar_result + '</p>'+\r\n\t\t'<p>test: getChar: case = ' + getChar_case + ', putChar: result = ' + myOutput + '</p>'+\r\n\t\t'<p>test: defined: cases = ' + defined_cases + ', results = ' + defined_results + '</p>'+\r\n\t\t'</body>'+\r\n\t\t'</html>';\r\n\t\r\n\tresponse.writeHead(200, {\"Content-Type\": \"text/html\"});\r\n\tresponse.write(body);\r\n\tresponse.end();\r\n}\r\n\r\nexports.start = start;\r\nexports.upload = upload;\r\nexports.show = show;\r\nexports.test = test;\r\n"]}